
use ast::Sexpr;

#[pub]
start -> Sexpr
        = list

list -> Sexpr
    = '(' space* body:element* ')'
      { Sexpr::List(Box::new(body)) }

element -> Sexpr
   = a:(atom / list) space* { a }

space = ' '

#[pub]
atom -> Sexpr
     = float
     / integer

integer -> Sexpr
        = [0-9]+ { Sexpr::Integer(match_str.parse().unwrap()) }

float -> Sexpr
        = ('+'/'-')? [0-9]+ ('.' [0-9]+) ('e' [0-9]+)? { Sexpr::Float(match_str.parse().unwrap()) }

